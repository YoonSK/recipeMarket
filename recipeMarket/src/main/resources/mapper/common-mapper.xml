<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="commonMapper">
	
	<resultMap id="replyResultSet" type="Reply">
		<id property="replyNo" column="REPLY_NO"/>
		<result property="nickName" column="NICKNAME"/>
		<result property="boardNo" column="BOARD_NO"/>
		<result property="targetNo" column="TARGET_NO"/>
		<result property="content" column="CONTENT"/>
		<result property="createDate" column="CREATE_DATE"/>
		<result property="modifyDate" column="MODIFY_DATE"/>
		<result property="rating" column="RATING"/>
		<result property="deleted" column="DELETED"/>
	</resultMap>
	
	<select id="selectReplies" parameterType="Reply" resultMap="replyResultSet">
		select NICKNAME, CONTENT, CREATE_DATE, MODIFY_DATE, RATING
		from REPLY R
		join MEMBER M using(MEMBER_NO)
		where BOARD_NO = #{boardNo}
		and TARGET_NO = #{targetNo}
		and R.DELETED ='N'
	</select>
	
	<insert id="insertReply" parameterType="Reply">
		<selectKey keyProperty="replyNo" resultType="int" order="BEFORE" >
			SELECT SEQ_REPLY_NO.NEXTVAL FROM DUAL
   		</selectKey>
	
		insert into Reply
		values(${replyNo}, #{memberNo}, #{boardNo}, #{targetNo}, #{content}, sysdate, sysdate, #{rating}, default)
	</insert>


	
</mapper>